{% extends "layout.html.j2" %}
{% block body %}
    {% if g.m_user %}
        <p>Mastodon: <strong>{{ g.m_user.username }}@{{ g.m_user.host }}</strong></p>

        <form method="POST" action="{{ url_for('logout') }}">
            <input type="submit" value="Logout">
        </form>

        <br>

        <form method="POST" action="{{ url_for('index') }}">
            {{ sform.comment.label }}:{{ sform.comment(size=500) }}<br>
            {{ sform.share_link.label }}:{{ sform.share_link(size=50) }}
            <div>Plug in any kind of streaming link you like.</div>
            <input type="submit" name="task" value="Preview">

            {% if is_preview %}
                <input type="submit" name="task" value="Save">
                <div>Preview</div>
                {{ preview_data }}
            {% endif %}
            {{ sform.csrf_token }}
        </form>
    {% else %}
        <form action="{{ url_for('mastodon_login') }}" method="POST">
            {{ mform.mastodon_id.label }}:{{ mform.mastodon_id(placeholder='yourid@mastodon.instance', size=30) }}
            {{ mform.csrf_token }}
            <input type=submit value="OK">
        </form>
    {% endif %}

{% endblock %}
